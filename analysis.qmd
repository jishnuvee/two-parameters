---
title: "Two-Parameters"
author : "Jishnu Veerapaneni"
format: html

execute: 
  echo: false
---

We are examining the heights of USMC recruits differing in sex so that we may determine uniforms for next year. The data was collected from a year ago and we are attempting to determine the average height of male and female USMC recruits. A potential weakness in our model is that the population and demographics of USMC recruits will vary from year to year, and because different demographics have different average heights, our predictions will never truly be accurate. We model height in USMC recruits, measured in centimeters for young adults aged 18â€“27 in the NHANES dataset, as a linear function of sex, a categorical variable with levels Female and Male. Specifically, the model estimates the average height for females (the baseline) and the additional height associated with being male.




```{r}
#| message: false
library(tidyverse)
library(primer.data)
library(tidymodels)
library(broom)
```


```{r}
set.seed(10)

x <- nhanes |>
  filter(age >= 18 & age <= 27) |>
  select(height, sex) |>
  drop_na() |>
  slice_sample(n = 50) 

```


```{r}
library(tidymodels)
fit_height <- linear_reg() |> 
  set_engine("lm") |> 
  fit(height ~ sex, data = x)


```


```{r}
linear_reg() |>
fit(height ~ sex, data = x) |>
tidy(conf.int = TRUE)
```

$$Y = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \cdots + \beta_n X_n + \epsilon$$

with $\epsilon \sim \mathcal{N}(0, \sigma^2)$.


```{r}
#| cache: true
set.seed(10)
nhanes |> 
  filter(age >= 18 & age <= 27) |> 
  select(height, sex) |> 
  drop_na() |> 
  slice_sample(n = 50) ->
nhanes_subset

fit_height <- linear_reg() |> 
  set_engine("lm") |> 
  fit(height ~ sex, data = nhanes_subset)

```
$$\hat{\text{height}} = 162.18 + 15.94 \cdot \text{sexMale}$$

```{r}

#| echo: true
library(broom)
library(gt)

# Assuming fit_height is available from previous chunk
# Create table with estimate and confidence intervals
tidy(fit_height, conf.int = TRUE) |> 
  select(term, estimate, conf.low, conf.high) |> 
  gt() |> 
  tab_header(title = "Linear Regression Model Coefficients") |> 
  cols_label(
    term = "Term",
    estimate = "Estimate",
    conf.low = "Lower CI",
    conf.high = "Upper CI"
  ) |> 
  fmt_number(
    columns = c(estimate, conf.low, conf.high),
    decimals = 2
  )


```

